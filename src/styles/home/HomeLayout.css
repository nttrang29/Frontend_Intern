/* =========================================================
   TOKENS
   ========================================================= */
:root {
  --radius: 22px;
  --gap: 18px;
  --text: #0f172a;
  --content-pad: 24px;

  /* Nền & viền */
  --main-bg: #f8fafc;
  --sidebar-bg: #ffffff;
  --header-bg: #ffffff;
  --content-bg: #f9fafb;
  --border-color: #e5e7eb;

  /* Sidebar / Topbar */
  --sb-w: 260px;       /* sidebar mở */
  --sb-wc: 78px;       /* sidebar thu gọn */
  --tb-h: 64px;        /* chiều cao topbar */

  /* Seam: chồng 1px để che border sidebar (liền mạch) */
  --sb-seam: 1px;

  /* Hiệu ứng chung sidebar/topbar/content */
  --sb-anim: 0.36s cubic-bezier(0.22, 0.61, 0.36, 1);
}

/* =========================================================
   PAGE WRAPPER
   ========================================================= */
.home-page {
  position: relative;
  min-height: 100vh;
  color: var(--text);
  background: var(--main-bg);
  overflow: hidden;

  /* mặc định: sidebar đang mở */
  --sb-current: var(--sb-w);
}

/* Khi body (hoặc wrapper cha) có class sb-collapsed */
.sb-collapsed .home-page {
  --sb-current: var(--sb-wc);
}

/* BG optional */
.home-page__bg {
  position: fixed;
  inset: 0;
  z-index: -2;
}
.home-page__bg-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.home-page__overlay {
  display: none;
}

/* =========================================================
   SIDEBAR — FLUSH
   ========================================================= */
.home__sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: var(--sb-current);       /* chạy theo biến */
  height: 100vh;
  z-index: 200;
  background: var(--sidebar-bg);
  color: var(--text);
  border-right: 1px solid var(--border-color);
  border-radius: 0;
  box-shadow: none;
  padding: 0;

  display: flex; /* allow inner layout (brand, nav, footer) */
  flex-direction: column;
  overflow: hidden; /* keep internal scroll region contained */

  transition: width var(--sb-anim);
}

/* fallback nếu JS chưa apply biến (có cũng được, không có cũng ok) */
.sb-collapsed .home__sidebar {
  width: var(--sb-wc);
}

/* =========================================================
   MAIN WRAP
   ========================================================= */
.home__wrap {
  display: flex;
  align-items: stretch;
  min-height: 100vh;
  gap: var(--gap);
  padding: 0;
}

/* Phần main bên phải sidebar */
.home__main {
  flex: 1;
  display: flex;
  flex-direction: column;

  margin-left: var(--sb-current);
  transition: margin-left var(--sb-anim);
}

.sb-collapsed .home__main {
  margin-left: var(--sb-wc); /* fallback */
}

/* =========================================================
   TOPBAR — FIXED, CHẠY THEO SIDEBAR
   ========================================================= */
.home__topbar {
  position: fixed;
  top: 0;
  left: calc(var(--sb-current) - var(--sb-seam)); /* dính mép sidebar */
  width: calc(100% - (var(--sb-current) - var(--sb-seam)));
  height: var(--tb-h);
  z-index: 600;
  display: flex;
  align-items: center;
  background: var(--header-bg);   /* nền base, bên trong tb__wrap bạn phủ màu */
  border-bottom: 1px solid var(--border-color);
  box-shadow: none;
  overflow: visible;              /* cho dropdown tràn xuống */

  transition:
    left var(--sb-anim),
    width var(--sb-anim);
}

/* fallback khi thu gọn */
.sb-collapsed .home__topbar {
  left: calc(var(--sb-wc) - var(--sb-seam));
  width: calc(100% - (var(--sb-wc) - var(--sb-seam)));
}

/* tb__wrap được style chi tiết trong Topbar.css,
   ở đây chỉ lo layer cho dropdown */
.home__topbar .tb__wrap {
  position: relative;   /* mốc cho dd__panel */
  z-index: 601;
  overflow: visible;
}

/* Panel dropdown trong topbar */
.dd__panel {
  position: absolute;
  top: calc(100% + 8px);  /* cách topbar 8px */
  right: 0;
  z-index: 9999;
}

/* =========================================================
   CONTENT (CUỘN DƯỚI TOPBAR)
   ========================================================= */
.home__content {
  flex: 1;
  padding: calc(var(--content-pad) + var(--tb-h))
           var(--content-pad)
           var(--content-pad);
  background: var(--content-bg);
  overflow-y: auto;
  position: relative;
  z-index: 1;
}

.home__content::-webkit-scrollbar {
  width: 8px;
}
.home__content::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.25);
  border-radius: 8px;
}
.home__content::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.35);
}

/* =========================================================
   EDGE BLEED (optional – block full width)
   ========================================================= */
.edge-bleed {
  margin-inline: calc(var(--content-pad) * -1);
  border-radius: 16px;
  background: var(--header-bg);
  border: 1px solid var(--border-color);
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
}

/* =========================================================
   TOAST dưới topbar
   ========================================================= */
.toast-portal {
  position: fixed;
  z-index: 350;
  top: calc(var(--tb-h) + 10px);
  right: var(--content-pad);
}

.sb-collapsed .toast-portal {
  right: var(--content-pad);
}

/* =========================================================
   LAYER ƯU TIÊN NỘI DUNG
   ========================================================= */
.home__content,
.home__main,
main {
  position: relative;
  z-index: 1;
}

/* When a modal is open, blur the underlying page content like the screenshot */
/* previously we used `.modal-blur` rules; now use a dim overlay + `.modal-exempt` to keep
   central content sharp. `.modal-exempt` is applied dynamically by the Modal component. */

.modal-exempt {
  position: relative;
  z-index: 1055; /* above the dim layer (1040) but below modal backdrop (1060) */
}

/* =========================================================
   RESPONSIVE (TABLET / MOBILE)
   ========================================================= */
@media (max-width: 768px) {
  /* padding nội dung nhỏ lại */
  :root {
    --content-pad: 12px;
  }

  /* Sidebar mobile nhỏ hơn chút, vẫn push layout (không overlay) */
  .home__sidebar {
    width: 220px;
    height: 100vh;
  }

  /* Khi sidebar đang MỞ trên mobile */
  .home__main {
    margin-left: 220px;
  }

  .home__topbar {
    left: 220px;
    right: 0;
    width: calc(100% - 220px);
  }

  /* Khi sidebar THU GỌN trên mobile */
  body.sb-collapsed .home__sidebar {
    width: var(--sb-wc);
  }
  body.sb-collapsed .home__main {
    margin-left: var(--sb-wc);
  }
  body.sb-collapsed .home__topbar {
    left: var(--sb-wc);
    width: calc(100% - var(--sb-wc));
  }
}

/* =========================================================
   UNIFIED PAGE HEADER + RESPONSIVE HELPERS
   Applies a wallet-like header visual (gradient, radius, padding)
   and ensures header controls and page sections respond when
   the viewport or zoom changes. Appended here so it's global.
   ========================================================= */
.unified-page-header,
.page-header-card,
.category-header-card,
.budget-header,
.funds-header,
.admin-header-card,
.dashboard-header {
  background: linear-gradient(90deg, #0c5776 0%, #2d99ae 100%) !important;
  color: #ffffff !important;
  border-radius: 24px !important;
  padding: 16px 20px !important;
  box-shadow: 0 10px 30px rgba(12, 87, 118, 0.22) !important;
  border: 1px solid rgba(255,255,255,0.06) !important;
  width: 100% !important;
  box-sizing: border-box !important;
}

/* Title style */
.unified-page-header .page-title,
.page-header-card .page-title,
.category-header-card .category-title,
.budget-header .budget-title,
.funds-header .funds-title,
.admin-header-card .admin-title,
.dashboard-header .dashboard-title {
  font-weight: 700 !important;
  font-size: 1.6rem !important;
  margin: 0 !important;
  color: #ffffff !important;
}

/* Header inner controls: flexible, wrap when needed, allow horizontal scroll on small viewports */
.unified-page-header .header-controls,
.page-header-card .header-controls,
.category-header-card .category-header-right,
.budget-header .budget-header-right,
.funds-header .funds-header-right {
  display: flex !important;
  align-items: center !important;
  gap: 12px !important;
  flex-wrap: nowrap !important;
  overflow-x: auto !important;
  -webkit-overflow-scrolling: touch !important;
}
.unified-page-header .header-controls::-webkit-scrollbar,
.page-header-card .header-controls::-webkit-scrollbar { display: none; }

/* Make main section cards adapt fluidly */
.tx-table-card,
.category-list-card,
.budget-card,
.funds-card {
  width: 100% !important;
  box-sizing: border-box !important;
}

/* Responsive table tweaks: let table shrink/expand with container */
.tx-table-card table,
.category-list-card table {
  width: 100% !important;
  table-layout: auto !important;
  word-break: break-word; /* allow cells to wrap */
}

/* Ensure card footers stay outside scrollable list areas */
.tx-table-card,
.category-list-card { display: flex; flex-direction: column; }
.tx-table-card .table-responsive,
.category-list-card .card-body { flex: 0 1 auto; }
.tx-table-card .card-footer,
.category-list-card .card-footer { margin-top: auto; }

/* Small viewport adjustments */
@media (max-width: 768px) {
  .unified-page-header,
  .page-header-card,
  .category-header-card { padding: 12px 14px !important; }
  .unified-page-header .page-title { font-size: 1.25rem !important; }
}
